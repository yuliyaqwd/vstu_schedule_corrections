# Система корректировки расписаний

Это веб-приложение на Django, предназначенное для автоматизированного обнаружения и исправления ошибок в учебных расписаниях. Система позволяет загружать Excel-файлы в формате .xlsx, управлять правилами коррекции через административный интерфейс и экспортировать исправленные расписания с полным сохранением оригинального оформления — включая цвета, шрифты, границы и объединённые ячейки.

Пользователь может просматривать список всех корректировок, отслеживать их статус (ожидает проверки, одобрено, недействительно), добавлять новые через админку и загружать файлы расписаний для последующей обработки. При экспорте расписания система автоматически подставляет одобренные исправления вместо исходных значений в соответствующих ячейках.

Проект включает вспомогательные функции для применения корректировок, экспорт данных в Excel (как расписания, так и самих корректировок), а также визуализацию пробелов в текстовых полях для упрощения диагностики ошибок.

## Требования

- Python 3.8+
- Django 4.x
- openpyxl
- pandas
- Браузер с поддержкой HTML5 и CSS3

## Установка

1. Клонируйте репозиторий и перейдите в корневую директорию проекта.
2. Создайте и активируйте виртуальное окружение.
3. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

4. Выполните миграции:

   ```bash
   python manage.py migrate
   ```

5. При необходимости создайте суперпользователя:

   ```bash
   python manage.py createsuperuser
   ```

6. Запустите сервер разработки:

   ```bash
   python manage.py runserver
   ```

После запуска откройте http://127.0.0.1:8000/ в браузере.

## Структура функционала

- Главная страница — общий обзор системы и навигация.
- Страница `/corrections/` — просмотр таблицы всех корректировок.
- Страница `/upload/` — загрузка Excel-файла расписания.
- Страница `/export/schedule/` — экспорт исправленного расписания с сохранением стилей.
- Страница `/export/corrections/` — экспорт всех корректировок в Excel.
- Админ-панель (`/admin/`) — управление корректировками, предметами и гипотезами.

## Ограничения

- Поддерживается только формат файлов .xlsx (не .xls).
- Глобальная переменная `last_uploaded_file_path` хранит путь к последнему загруженному файлу, что делает систему непригодной для одновременной работы нескольких пользователей без доработки (например, хранения файлов в сессиях или привязки к пользователю).
- Все корректировки применяются с `scope_id=0` при экспорте расписания — для поддержки нескольких контекстов (например, разных факультетов) требуется расширение логики.

## Авторы

Левин Д.И.
Рубанская Ю.Б.
Одиноков В.Д.
Поморов А.О.
Группа: ПрИн-367, ФЭВТ.
